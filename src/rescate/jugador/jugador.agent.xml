<agent xmlns="http://jadex.sourceforge.net/jadex" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jadex.sourceforge.net/jadex http://jadex.sourceforge.net/jadex-0.96.xsd" name="jugador" package="rescate.jugador">

  <imports>
    <import>jadex.runtime.*</import>
    <import>jadex.planlib.*</import>
    <import>jadex.adapter.fipa.*</import>
    <import>jadex.util.*</import>

    <import>java.util.logging.*</import>
    <import>java.util.*</import>

    <import>rescate.ontologia.acciones.*</import>
    <import>rescate.ontologia.conceptos.*</import>
    <import>rescate.ontologia.predicados.*</import>

    <import>rescate.jugador.planes.*</import>
    <import>rescate.jugador.util.*</import>
  </imports>

  <capabilities>
    <capability name="dfcap" file="jadex.planlib.DF" />
  </capabilities>

  <!-- CREENCIAS -->
  <beliefs>

    <!-- Estrategia -->
    <belief name="estrategia" class="int">
      <fact>Estrategias.Ninguna</fact>
    </belief>

    <belief name="casillaEstrategia" class="int[]">
      <fact>new int[] { -1, -1 }</fact>
    </belief>

    <belief name="conexionEstrategia" class="int">
      <fact>-1</fact>
    </belief>

    <!-- Info (principio turno) -->
    <belief name="tieneInfo" class="boolean">
      <fact>false</fact>
    </belief>

    <belief name="info" class="Info">
      <fact>new Info()</fact>
    </belief>

    <!-- Jugadores -->
    <belief name="jugador" class="Jugador">
      <fact>new Jugador()</fact>
    </belief>

    <beliefset name="jugadoresHabitacion" class="Jugador"></beliefset>

    <!-- Puntos de Accion -->
    <belief name="PA" class="int">
      <fact>0</fact>
    </belief>

    <belief name="PAMando" class="int">
      <fact>0</fact>
    </belief>

    <belief name="PAExtincion" class="int">
      <fact>0</fact>
    </belief>

    <belief name="PAMovimiento" class="int">
      <fact>0</fact>
    </belief>

    <!-- Tablero -->
    <belief name="tablero" class="AgentIdentifier">
      <fact>new AgentIdentifier()</fact>
    </belief>

    <!-- Turno -->
    <belief name="esTurno" class="boolean">
      <fact>false</fact>
    </belief>

  </beliefs>

  <!-- METAS -->
  <goals>

    <!-- Registro en páginas amarillas -->
    <achievegoalref name="df_register">
      <concrete ref="dfcap.df_register" />
    </achievegoalref>

    <!-- Búsqueda de tablero -->
    <achievegoalref name="df_search">
      <concrete ref="dfcap.df_search" />
    </achievegoalref>

    <!-- Unirse a la partida para jugar -->
    <achievegoal name="unirsePartida" />

    <!-- Acabar turno -->
    <performgoal name="acabarTurno" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.estrategia == Estrategias.AcabarTurno
      </creationcondition>
    </performgoal>

    <!-- Abrir -->
    <performgoal name="abrirPuerta" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.estrategia == Estrategias.AbrirPuerta
      </creationcondition>
    </performgoal>

    <!-- Apagar cosas -->
    <performgoal name="apagarFuego" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.estrategia == Estrategias.ApagarFuego
      </creationcondition>
    </performgoal>

    <!-- Decidir estrategia -->
    <performgoal name="decidirEstrategia" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.tieneInfo &amp;&amp;
				$beliefbase.estrategia == Estrategias.Ninguna
      </creationcondition>
    </performgoal>

    <!-- Apagar cosas -->
    <performgoal name="desplazarse" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.estrategia == Estrategias.Desplazarse
      </creationcondition>
    </performgoal>

    <!-- Obtener info (inicio turno) -->
    <performgoal name="obtenerInfo" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.tieneInfo == false
      </creationcondition>
    </performgoal>

  </goals>

  <!-- PLANES -->
  <plans>

    <!-- Abrir -->
    <plan name="AbrirPuerta">
      <body class="AbrirPuertaPlan" />
      <trigger>
        <goal ref="abrirPuerta" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno &amp;&amp;
        $beliefbase.estrategia == Estrategias.AbrirPuerta
      </contextcondition>
    </plan>

    <!-- Apagar -->
    <plan name="ApagarFuego">
      <body class="ApagarFuegoPlan" />
      <trigger>
        <goal ref="apagarFuego" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno &amp;&amp;
        $beliefbase.estrategia == Estrategias.ApagarFuego
      </contextcondition>
    </plan>

    <!-- Desplazarse -->
    <plan name="Desplazarse">
      <body class="DesplazarsePlan" />
      <trigger>
        <goal ref="desplazarse" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno &amp;&amp;
        $beliefbase.estrategia == Estrategias.Desplazarse
      </contextcondition>
    </plan>

    <!-- Estrategia -->
    <plan name="DecidirEstrategia">
      <body class="DecidirEstrategiaPlan" />
      <trigger>
        <goal ref="decidirEstrategia" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno &amp;&amp;
        $beliefbase.estrategia == Estrategias.Ninguna &#124;&#124;
        $beliefbase.estrategia == Estrategias.Decidiendo
      </contextcondition>
    </plan>

    <!-- Información -->
    <plan name="DarInformacion">
      <body class="DarInfoPlan" />
      <trigger>
        <messageevent ref="Inform_Info" />
      </trigger>
    </plan>

    <plan name="ObtenerInfo">
      <body class="ObtenerInfoPlan" />
      <trigger>
        <goal ref="obtenerInfo" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno
      </contextcondition>
    </plan>

    <!-- Turno -->
    <plan name="AcabarTurno">
      <body class="AcabarTurnoPlan" />
      <trigger>
        <goal ref="acabarTurno" />
      </trigger>
      <contextcondition>
        $beliefbase.esTurno &amp;&amp;
        $beliefbase.estrategia == Estrategias.AcabarTurno
      </contextcondition>
    </plan>

    <plan name="EmpezarTurno">
      <body class="EmpezarTurnoPlan" />
      <trigger>
        <messageevent ref="Inform_Turno_Asignado" />
      </trigger>
    </plan>

    <!-- Unirse a la partida -->
    <plan name="UnirsePartida">
      <body class="UnirsePartidaPlan" />
      <trigger>
        <goal ref="unirsePartida" />
      </trigger>
    </plan>

  </plans>

  <!-- EVENTOS -->
  <events>

    <!-- Abrir puerta -->
    <messageevent name="Request_Abrir_Puerta" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>AbrirPuerta.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Puerta_Abierta" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>PuertaAbierta.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Abrir_Puerta" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>AbrirPuerta.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Failure_Abrir_Puerta" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.FAILURE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>AbrirPuerta.class</value>
      </parameter>
    </messageevent>

    <!-- Apagar fuego -->
    <messageevent name="Request_Apagar_Fuego" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>ApagarFuego.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Fuego_Apagado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>FuegoApagado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Apagar_Fuego" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>ApagarFuego.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Failure_Apagar_Fuego" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.FAILURE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>ApagarFuego.class</value>
      </parameter>
    </messageevent>

    <!-- Cambiar Turno -->
    <messageevent name="Request_Cambiar_Turno" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>CambiarTurno.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Turno_Cambiado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>TurnoCambiado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Turno_Asignado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>TurnoAsignado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Cambiar_Turno" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>CambiarTurno.class</value>
      </parameter>
    </messageevent>

    <!-- Dar Información -->
    <messageevent name="Request_Info" direction="send_receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Info" direction="send_receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Info.class</value>
      </parameter>
    </messageevent>


    <!-- Desplazar jugador -->
    <messageevent name="Request_Desplazar" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Desplazar.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Desplazado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Desplazado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Desplazar" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Desplazar.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Failure_Desplazar" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.FAILURE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Desplazar.class</value>
      </parameter>
    </messageevent>

    <!-- Elegir Rol -->
    <messageevent name="Request_Elegir_Rol" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>ElegirRol.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Rol_Elegido" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>RolElegido.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Elegir_Rol" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>RolesDisponibles.class</value>
      </parameter>
    </messageevent>

    <!-- Unirse partida -->
    <messageevent name="Request_Unirse_Partida" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Jugador_Unido" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>JugadorUnido.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Unirse_Partida" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Failure_Unirse_Partida" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.FAILURE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

  </events>

  <!-- Propiedades -->
  <properties></properties>

  <!-- Configuracion -->
  <configurations>
    <configuration name="default">

      <goals>
        <initialgoal ref="df_register">
          <parameter ref="description">
            <value>
							SFipa.createAgentDescription(null, SFipa.createServiceDescription("jugador", "agente", "Rescate"))
						</value>
          </parameter>
        </initialgoal>

        <initialgoal ref="unirsePartida" />
      </goals>

    </configuration>
  </configurations>

</agent>
