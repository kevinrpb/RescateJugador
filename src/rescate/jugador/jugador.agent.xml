<agent xmlns="http://jadex.sourceforge.net/jadex" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jadex.sourceforge.net/jadex http://jadex.sourceforge.net/jadex-0.96.xsd" name="jugador" package="rescate.jugador">

  <imports>
    <import>jadex.runtime.*</import>
    <import>jadex.planlib.*</import>
    <import>jadex.adapter.fipa.*</import>
    <import>jadex.util.*</import>

    <import>java.util.logging.*</import>
    <import>java.util.*</import>

    <import>rescate.ontologia.acciones.*</import>
    <import>rescate.ontologia.conceptos.*</import>
    <import>rescate.ontologia.predicados.*</import>

    <import>rescate.jugador.planes.*</import>
    <import>rescate.jugador.util.*</import>
  </imports>

  <capabilities>
    <capability name="dfcap" file="jadex.planlib.DF" />
  </capabilities>

  <!-- CREENCIAS -->
  <beliefs>

    <!-- Info (principio turno) -->
    <belief name="tieneInfo" class="boolean">
      <fact>false</fact>
    </belief>

    <belief name="info" class="Info">
      <fact>new Info()</fact>
    </belief>

    <!-- Jugadores -->
    <belief name="jugador" class="Jugador">
      <fact>new Jugador()</fact>
    </belief>

    <beliefset name="jugadoresHabitacion" class="Jugador">
    </beliefset>

    <!-- Puntos de Accion -->

    <!-- Tablero -->
    <belief name="tablero" class="AgentIdentifier">
      <fact>new AgentIdentifier()</fact>
    </belief>

    <!-- Turno -->
    <belief name="esTurno" class="boolean">
      <fact>false</fact>
    </belief>

  </beliefs>

  <!-- METAS -->
  <goals>

    <!-- Registro en páginas amarillas -->
    <achievegoalref name="df_register">
      <concrete ref="dfcap.df_register" />
    </achievegoalref>

    <!-- Búsqueda de tablero -->
    <achievegoalref name="df_search">
      <concrete ref="dfcap.df_search" />
    </achievegoalref>

    <!-- Unirse a la partida para jugar -->
    <achievegoal name="unirsePartida" />

    <!-- Obtener info (inicio turno) -->
    <performgoal name="obtenerInfo" retry="false">
      <creationcondition>
        $beliefbase.esTurno &amp;&amp;
				$beliefbase.tieneInfo == false
      </creationcondition>
    </performgoal>

  </goals>

  <!-- PLANES -->
  <plans>

    <!-- Empezar Turno -->
    <plan name="EmpezarTurno">
      <body class="EmpezarTurnoPlan" />
      <trigger>
        <messageevent ref="Inform_Turno_Asignado" />
      </trigger>
    </plan>

    <!-- Información -->
    <plan name="DarInformacion">
      <body class="DarInfoPlan" />
      <trigger>
        <messageevent ref="Inform_Info" />
      </trigger>
    </plan>

    <plan name="ObtenerInfo">
      <body class="ObtenerInfoPlan" />
      <trigger>
        <goal ref="obtenerInfo" />
      </trigger>
      <contextcondition>$beliefbase.esTurno</contextcondition>
    </plan>

    <!-- Unirse a la partida -->
    <plan name="UnirsePartida">
      <body class="UnirsePartidaPlan" />
      <trigger>
        <goal ref="unirsePartida" />
      </trigger>
    </plan>

  </plans>

  <!-- EVENTOS -->
  <events>

    <!-- Cambiar Turno -->
    <messageevent name="Request_Cambiar_Turno" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
        <value>SFipa.createUniqueId($scope.getAgentName())</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>CambiarTurno.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Turno_Cambiado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>TurnoCambiado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Turno_Asignado" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>TurnoAsignado.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Cambiar_Turno" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>CambiarTurno.class</value>
      </parameter>
    </messageevent>

    <!-- Dar Información -->
    <messageevent name="Request_Info" direction="send_receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
    </messageevent>

    <messageevent name="Inform_Info" direction="send_receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>Info.class</value>
      </parameter>
    </messageevent>

    <!-- Elegir Rol -->
    <messageevent name="Request_Elegir_Rol" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>ElegirRol.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Rol_Elegido" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>RolElegido.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Elegir_Rol" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>RolesDisponibles.class</value>
      </parameter>
    </messageevent>

    <!-- Unirse partida -->
    <messageevent name="Request_Unirse_Partida" direction="send" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REQUEST</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="conversation-id" class="String">
				<value>SFipa.createUniqueId($scope.getAgentName())</value>
			</parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Inform_Jugador_Unido" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.INFORM</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>JugadorUnido.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Refuse_Unirse_Partida" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.REFUSE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

    <messageevent name="Failure_Unirse_Partida" direction="receive" type="fipa">
      <parameter name="performative" class="String" direction="fixed">
        <value>SFipa.FAILURE</value>
      </parameter>
      <parameter name="language" class="String" direction="fixed">
        <value>SFipa.NUGGETS_XML</value>
      </parameter>
      <parameter name="content-class" class="Class" direction="fixed">
        <value>UnirsePartida.class</value>
      </parameter>
    </messageevent>

  </events>

  <!-- Propiedades -->
  <properties></properties>

  <!-- Configuracion -->
  <configurations>
    <configuration name="default">

      <goals>
        <initialgoal ref="df_register">
          <parameter ref="description">
            <value>
							SFipa.createAgentDescription(null, SFipa.createServiceDescription("jugador", "agente", "Rescate"))
						</value>
          </parameter>
        </initialgoal>

        <initialgoal ref="unirsePartida" />
      </goals>

    </configuration>
  </configurations>

</agent>
